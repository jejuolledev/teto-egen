<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>í…ŒìŠ¤íŠ¸ ì§„í–‰ ì¤‘ - í…Œí†  vs ì• ê²</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container test-container">
    <!-- í”„ë¡œê·¸ë ˆìŠ¤ ë°” -->
    <div class="progress-wrapper">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <p class="progress-text">
        <span id="currentQ">1</span> / <span id="totalQ">15</span>
      </p>
    </div>

    <!-- ì„±ë³„ ì„ íƒ (ì²« í™”ë©´) -->
    <div class="gender-selection" id="genderSelection">
      <h2 class="question-title">ë¨¼ì €, ë‹¹ì‹ ì˜ ì„±ë³„ì€?</h2>
      <div class="gender-buttons">
        <button class="gender-btn" onclick="selectGender('male')">
          <span class="gender-emoji">ğŸ‘¨</span>
          <span class="gender-text">ë‚¨ì</span>
        </button>
        <button class="gender-btn" onclick="selectGender('female')">
          <span class="gender-emoji">ğŸ‘©</span>
          <span class="gender-text">ì—¬ì</span>
        </button>
      </div>
    </div>

    <!-- ì§ˆë¬¸ ì˜ì—­ -->
    <div class="question-section" id="questionSection" style="display: none;">
      <div class="question-card">
        <h2 class="question-title" id="questionText">ì§ˆë¬¸ì´ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤</h2>
        
        <div class="options" id="optionsContainer">
          <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
        </div>
      </div>

      <!-- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ -->
      <button class="back-btn" id="backBtn" onclick="previousQuestion()" style="display: none;">
        â† ì´ì „ ì§ˆë¬¸
      </button>
    </div>
  </div>

  <script type="module">
    import { questions, calculateResult } from './questions.js';
    
    let currentQuestion = 0;
    let answers = [];
    let userGender = null;

    // ì „ì—­ìœ¼ë¡œ ë…¸ì¶œ
    window.questions = questions;
    window.currentQuestion = currentQuestion;
    window.answers = answers;
    window.userGender = userGender;
    
    window.selectGender = function(gender) {
      window.userGender = gender;
      localStorage.setItem('userGender', gender);
      
      document.getElementById('genderSelection').style.display = 'none';
      document.getElementById('questionSection').style.display = 'block';
      
      showQuestion();
    };
    
    window.selectOption = function(score) {
      window.answers[window.currentQuestion] = score;
      
      window.currentQuestion++;
      
      if (window.currentQuestion < questions.length) {
        showQuestion();
      } else {
        // í…ŒìŠ¤íŠ¸ ì™„ë£Œ, ê²°ê³¼ ê³„ì‚°
        const result = calculateResult(window.answers, window.userGender);
        localStorage.setItem('testResult', JSON.stringify(result));
        
        // ê´‘ê³  í™”ë©´ìœ¼ë¡œ ì´ë™
        window.location.href = 'ad.html';
      }
    };
    
    window.previousQuestion = function() {
      if (window.currentQuestion > 0) {
        window.currentQuestion--;
        showQuestion();
      }
    };
    
    function showQuestion() {
      const q = questions[window.currentQuestion];
      
      // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
      const progress = ((window.currentQuestion + 1) / questions.length) * 100;
      document.getElementById('progressFill').style.width = progress + '%';
      document.getElementById('currentQ').textContent = window.currentQuestion + 1;
      document.getElementById('totalQ').textContent = questions.length;
      
      // ì§ˆë¬¸ í…ìŠ¤íŠ¸
      document.getElementById('questionText').textContent = q.question;
      
      // ì„ íƒì§€ ìƒì„±
      const optionsHtml = q.options.map((opt, idx) => `
        <button class="option-btn" onclick="selectOption(${opt.score})">
          ${opt.text}
        </button>
      `).join('');
      
      document.getElementById('optionsContainer').innerHTML = optionsHtml;
      
      // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ í‘œì‹œ ì—¬ë¶€
      if (window.currentQuestion > 0) {
        document.getElementById('backBtn').style.display = 'block';
      } else {
        document.getElementById('backBtn').style.display = 'none';
      }
    }
  </script>
</body>
</html>
